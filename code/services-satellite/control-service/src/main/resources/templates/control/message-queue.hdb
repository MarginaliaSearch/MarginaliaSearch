<!DOCTYPE html>
<html>
<head>
    <title>Control Service</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
  {{> control/partials/nav}}

  <section>
      <h1>Message Queue</h1>

      <table id="queue">
          <tr>
            <th>State<br>TTL</th>
            <th>Msg ID<br>Related ID</th>
            <th>Recipient<br>Sender</th>
            <th>Function</th>
            <th>Owner Instance<br>Owner Tick</th>
            <th>Created<br>Updated</th>
          </tr>
          {{#each messages}}
          <tr>
            <td>{{stateCode}}&nbsp;{{state}}</td>
            <td>{{id}}</td>
            <td>{{recipientInbox}}</td>
            <td>{{function}}</td>
            <td title="{{ownerInstanceFull}}">
              <span style="background-color: {{ownerInstanceColor}}" class="uuidPip">&nbsp;</span><span style="background-color: {{ownerInstanceColor2}}" class="uuidPip">&nbsp;</span>&nbsp;{{ownerInstance}}
            </td>
            <td>{{createdTime}}</td>
           </tr>
          <tr>
              <td>{{ttl}}</td>
              <td>{{relatedId}}</td>
              <td>{{senderInbox}}</td>
              <td></td>
              <td>{{ownerTick}}</td>
              <td>{{updatedTime}}</td>
          </tr>
            {{/each}}
      </table>
  </section>
</body>
<script src="/refresh.js"></script>
<script>
    window.setInterval(() => {
        refresh(["queue"]);
    }, 5000);
</script>
</html>