<!doctype html>
<html>
{{> control/partials/head-includes }}
<head><title>Control Service: Node {{node.id}}</title></head>
<body>
{{> control/partials/nav}}

<div class="container">

    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/nodes">nodes</a></li>
            <li class="breadcrumb-item">node-{{node.id}}</li>
        </ol>
    </nav>

    <nav class="nav nav-tabs">
        <li class="nav-item">
            <a class="nav-link" href="/nodes/{{node.id}}/">Overview</a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" href="/nodes/{{node.id}}/actions">Actions</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/nodes/{{node.id}}/actors">Actors</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/nodes/{{node.id}}/storage/">Storage</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/nodes/{{node.id}}/configuration">Configuration</a>
        </li>

    </nav>

    <div class="accordion mt-1" id="accordionActions">
        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseSideloadEncyclopedia"
                        aria-expanded="false"
                        aria-controls="collapseSideloadEncyclopedia">
                    Sideload Encyclopedia
                </button>
            </h2>
            <div id="collapseSideloadEncyclopedia" class="accordion-collapse collapse p-3" data-bs-parent="#accordionActions">

                This will load pre-digested encyclopedia data from an <tt>encyclopedia.marginalia.nu</tt>-style database.

            <form method="post" action="actions/sideload-encyclopedia" onsubmit="return confirm('Confirm sideloading')">
                <div class="my-3 py-3">

                    <label for="baseUrl" class="form-label">Base URL</label>
                    <div class="col mb-3">
                        <input id="baseUrl" name="baseUrl" class="form-control" value="https://en.wikipedia.org/wiki/">
                    </div>

                    <label for="source" class="form-label">Path to articles.db accessible from the node on the server</label>

                    <div class="row">
                        <div class="col">
                            <input id="source" name="source" class="form-control" value="">
                        </div>
                        <div class="col">
                            <button type="submit" class="btn btn-primary">Sideload Encyclopedia</button>
                        </div>
                    </div>
                </div>
            </form>
            </div>
        </div>

        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseSideloadStackexchange"
                        aria-expanded="false"
                        aria-controls="collapseSideloadStackexchange">
                    Sideload Stackexchange
                </button>
            </h2>
            <div id="collapseSideloadStackexchange" class="accordion-collapse collapse p-3" data-bs-parent="#accordionActions">
                This will load a set of pre-converted stackexchange .db files

                <form method="post" action="actions/sideload-stackexchange" onsubmit="return confirm('Confirm sideloading')">
                    <div class="my-3 py-3">
                        <label for="source" class="form-label">Directory with .db files accessible from the node on the server</label>

                        <div class="row">
                            <div class="col">
                                <input id="source" name="source" class="form-control" value="">
                            </div>
                            <div class="col">
                                <button type="submit" class="btn btn-primary">Sideload Stackexchange</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseSideloadDirtree"
                        aria-expanded="false"
                        aria-controls="collapseSideloadDirtree">
                    Sideload Dirtree
                </button>
            </h2>
            <div id="collapseSideloadDirtree" class="accordion-collapse collapse p-3" data-bs-parent="#accordionActions">
                This will load HTML from a directory structure as specified by a YAML file.

                <form method="post" action="actions/sideload-dirtree" onsubmit="return confirm('Confirm sideloading')">
                    <div class="my-3 py-3">
                        <label for="source" class="form-label">yaml file location on server</label>

                        <div class="row">
                            <div class="col">
                                <input id="source" name="source" class="form-control" value="">
                            </div>
                            <div class="col">
                                <button type="submit" class="btn btn-primary">Sideload Dirtree</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapseRepartition"
                        aria-expanded="true"
                        aria-controls="collapseRepartition">
                    Repartition Index
                </button>
            </h2>
            <div id="collapseRepartition" class="accordion-collapse collapse p-3" data-bs-parent="#accordionActions">
                <p>This will recalculate the rankings and search sets for the index</p>

                <form method="post" action="actions/repartition-index" onsubmit="return confirm('Confirm repartition')">
                    <button type="submit" class="btn btn-primary">Trigger Repartitioning</button>
                </form>
            </div>
        </div>
    </div>

<!--    <table style="max-width: 80ch">-->
<!--        <tr>-->
<!--            <th>Action</th><th>Trigger</th>-->
<!--        </tr>-->
<!--        <tr>-->
<!--            <td><b>Trigger Adjacency Calculation</b><p>-->
<!--                This will trigger a recalculation of website similarities, which affects-->
<!--                the rankings calculations.-->
<!--            </td>-->
<!--            <td>-->
<!--                <form method="post" action="/actions/calculate-adjacencies" onsubmit="return confirm('Confirm adjacency recalculation')">-->
<!--                    <input type="submit" value="Trigger Calculations">-->
<!--                </form>-->
<!--            </td>-->
<!--        </tr>-->
<!--        <tr>-->

<!--        </tr>-->

<!--        <tr>-->
<!--            <td>-->
<!--                <b>Reload Blogs List</b>-->
<!--                <p>This will reload the list of blogs from its source.</p>-->
<!--            </td>-->
<!--            <td>-->
<!--                <form method="post" action="/actions/reload-blogs-list" onsubmit="return confirm('Confirm reload blogs list')">-->
<!--                    <input type="submit" value="Reload Blogs List">-->
<!--                </form>-->
<!--            </td>-->
<!--        </tr>-->
<!--        <tr>-->
<!--            <td><b>Repartition Index</b><p>-->
<!--                This will recalculate the rankings and search sets for the index.-->
<!--            </td>-->
<!--            <td>-->
<!--                <form method="post" action="/actions/repartition-index" onsubmit="return confirm('Confirm repartition')">-->
<!--                    <input type="submit" value="Trigger Repartitioning">-->
<!--                </form>-->
<!--            </td>-->
<!--        </tr>-->
<!--        <tr>-->
<!--            <td><b>Flush <tt>api-service</tt> Caches</b><p>-->
<!--                This will instruct the api-service to flush its caches,-->
<!--                getting rid of any stale data.  This will be necessary after-->
<!--                changes to the API licenses directly through the database.-->
<!--            </td>-->
<!--            <td>-->
<!--                <form method="post" action="/actions/flush-api-caches" onsubmit="return confirm('Confirm flushing api chaches')">-->
<!--                    <input type="submit" value="Flush API">-->
<!--                </form>-->
<!--            </td>-->
<!--        </tr>-->
<!--        <tr>-->
<!--            <td><b>Trigger Data Exports</b><p>-->
<!--                This exports the data from the database into a set of CSV files-->
<!--            </td>-->
<!--            <td>-->
<!--                <form method="post" action="/actions/trigger-data-exports" onsubmit="return confirm('Confirm triggering of exports')">-->
<!--                    <input type="submit" value="Export Data">-->
<!--                </form>-->
<!--            </td>-->
<!--        </tr>-->
<!--        <tr>-->
<!--            <th colspan="2">-->
<!--                WARNING -- Destructive Actions Below This Line-->
<!--            </th>-->
<!--        </tr>-->
<!--        <tr>-->
<!--            <td><b>Truncate Links Database.</b><p>-->
<!--                <span style="color:red">This will drop all known URLs and domain links.</span><br>-->
<!--                This action is not reversible.-->
<!--            </td>-->
<!--            <td>-->
<!--                <form method="post" action="/actions/truncate-links-database" onsubmit="return confirm('Last chance, you are about to flush the link database')">-->
<!--                    <label for="footgun-license">Type exactly "YES" to confirm</label><br>-->
<!--                    <input id="footgun-license" name="footgun-license" value="NO">-->
<!--                    <br><br>-->
<!--                    <input type="submit" value="TRUNCATE TABLE ...">-->
<!--                </form>-->
<!--            </td>-->
<!--        </tr>-->
<!--    </table>-->
</div>

</body>
{{> control/partials/foot-includes }}
</html>